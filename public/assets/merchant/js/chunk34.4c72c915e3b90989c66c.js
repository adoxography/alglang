webpackJsonp([34],{LZch:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("2jId"),i={props:["value","disabled"],data:function(){return{showModal:!1,showDescription:!1,focusedSource:{index:0,description:""},oldSource:{text:"",id:""}}},computed:{hasDuplicates:function(){for(var e=this.value,t=!1,s=0;s<e.length&&!t;s++)t=this.duplicateSource(e[s].id);return t}},directives:{focus:o.focus},methods:{open:function(){this.showModal=!0},close:function(){this.showModal=!1},add:function(e){var t=this,s=this.value;s.push({short:e.display,id:e.id,long:e.long,extraInfo:""}),this.$emit("input",s),Vue.nextTick(function(){t.$refs.extrainfo[t.value.length-1].focus()})},remove:function(e){var t=this.value;t.splice(e,1),this.$emit("input",t)},openDescriptionModal:function(e){var t=this.value;this.focusedSource.description=t[e].description,this.focusedSource.index=e,this.showDescription=!0},saveDescription:function(){var e=this.value;e[this.focusedSource.index].description=this.focusedSource.description,this.showDescription=!1,this.$emit("input",e)},duplicateSource:function(e){var t=this.value,s=!1,o=!1;return t&&t.forEach(function(t){t.id==e&&(s?o=!0:s=!0)}),o},handleOldSourceInput:function(){var e=this;Vue.nextTick(function(){e.$refs.oldSource.showCheck&&(e.add({display:e.oldSource.extra,id:e.oldSource.id,long:e.oldSource.text}),e.oldSource.text="",e.oldSource.id="",e.oldSource.extra="")})}}},a=s("XyMi"),n=Object(a.a)(i,function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h4",{staticClass:"subtitle is-4"},[e._v("Sources")]),e._v(" "),s("div",{staticClass:"columns"},[s("div",{staticClass:"column is-8"},[s("label",{staticClass:"label",attrs:{for:"old-source"}},[e._v("Look up an existing source:")]),e._v(" "),s("alg-ajaxlist",{ref:"oldSource",attrs:{uri:"/autocomplete/sources",placeholder:"Search for an existing source",name:"old-source",id:"old-source",disabled:e.disabled},on:{input:e.handleOldSourceInput},model:{value:e.oldSource,callback:function(t){e.oldSource=t},expression:"oldSource"}})],1),e._v(" "),s("div",{staticClass:"column",staticStyle:{display:"flex","justify-content":"center"}},[s("a",{staticClass:"button",class:{"is-disabled":e.disabled},staticStyle:{"margin-top":"2rem"},attrs:{id:"new-source-button"},on:{click:e.open}},[e._v("\n\t\t\t\t   \tAdd a new source\n\t\t\t    ")])])]),e._v(" "),s("ul",e._l(e.value,function(t,o){return s("div",[s("div",{staticClass:"columns"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.id,expression:"source.id"}],attrs:{type:"hidden",name:"sources["+o+"][id]"},domProps:{value:t.id},on:{input:function(s){s.target.composing||e.$set(t,"id",s.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.short,expression:"source.short"}],attrs:{type:"hidden",name:"sources["+o+"][short]"},domProps:{value:t.short},on:{input:function(s){s.target.composing||e.$set(t,"short",s.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.long,expression:"source.long"}],attrs:{type:"hidden",name:"sources["+o+"][long]"},domProps:{value:t.long},on:{input:function(s){s.target.composing||e.$set(t,"long",s.target.value)}}}),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"source.description"}],attrs:{type:"hidden",name:"sources["+o+"][description]"},domProps:{value:t.description},on:{input:function(s){s.target.composing||e.$set(t,"description",s.target.value)}}}),e._v(" "),s("div",{staticClass:"column is-one-quarter"},[s("div",[s("p",{attrs:{title:t.long}},[e._v(e._s(o+1)+". "+e._s(t.short))]),e._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.duplicateSource(t.id),expression:"duplicateSource(source.id)"}],staticClass:"help is-danger",domProps:{textContent:e._s("This source is already listed")}})])]),e._v(" "),s("div",{staticClass:"column is-7"},[s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.extraInfo,expression:"source.extraInfo"}],ref:"extrainfo",refInFor:!0,staticClass:"input is-expanded",attrs:{type:"text",name:"sources["+o+"][extraInfo]",placeholder:"chapter, page number, etc...",disabled:e.disabled,autocomplete:"off"},domProps:{value:t.extraInfo},on:{input:function(s){s.target.composing||e.$set(t,"extraInfo",s.target.value)}}})])]),e._v(" "),s("div",{staticClass:"column is-1"},[s("a",{staticClass:"button",class:{"is-primary":t.description&&t.description.length>0},on:{click:function(t){e.openDescriptionModal(o)}}},[e._v(" Desc ")])]),e._v(" "),s("div",{staticClass:"column is-1"},[s("a",{staticClass:"button",attrs:{disabled:e.disabled},on:{click:function(t){e.remove(o)}}},[e._v("Remove")])])])])})),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.showDescription,expression:"showDescription"}],staticClass:"modal is-active"},[s("div",{staticClass:"modal-background"}),e._v(" "),s("div",{staticClass:"modal-card"},[e._m(0),e._v(" "),s("section",{staticClass:"modal-card-body"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.focusedSource.description,expression:"focusedSource.description"}],staticClass:"textarea",domProps:{value:e.focusedSource.description},on:{input:function(t){t.target.composing||e.$set(e.focusedSource,"description",t.target.value)}}})]),e._v(" "),s("footer",{staticClass:"modal-card-foot"},[s("a",{staticClass:"button is-success",on:{click:e.saveDescription}},[e._v("Save")]),e._v(" "),s("a",{staticClass:"button is-danger",on:{click:function(t){e.showDescription=!1}}},[e._v("Cancel")])])])]),e._v(" "),s("alg-new-source",{directives:[{name:"show",rawName:"v-show",value:e.showModal,expression:"showModal"}],attrs:{open:e.showModal},on:{close:e.close,input:function(t){e.add(t)}}})],1)},[function(){var e=this.$createElement,t=this._self._c||e;return t("header",{staticClass:"modal-card-head"},[t("p",{staticClass:"modal-card-title"},[this._v("Description")])])}],!1,null,null,null);t.default=n.exports}});