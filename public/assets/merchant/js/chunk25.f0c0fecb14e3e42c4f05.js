webpackJsonp([25],{"+nsO":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("WEHx"),s={props:["name","id","value","with","uri","placeholder","disabled","initial"],data:function(){return{showList:!1,options:[],loading:!1,curr:0,extra:""}},directives:{onClickaway:i.directive},computed:{showCheck:function(){return!this.loading&&this.value.id>0&&!this.showList}},mounted:function(){var t=this;this.$refs.list.contentEditable=!0,this.initial&&Vue.nextTick(function(){t.$emit("input",t.initial)})},methods:{onEnter:function(t){this.showList&&(t.preventDefault(),this.selectItem(this.options[this.curr-1].name))},setEndOfContenteditable:function(t){var e,n;document.createRange?((e=document.createRange()).selectNodeContents(t),e.collapse(!1),(n=window.getSelection()).removeAllRanges(),n.addRange(e)):document.selection&&((e=document.body.createTextRange()).moveToElementText(t),e.collapse(!1),e.select())},closeList:function(){this.showList=!1},determineValue:function(t){var e=!1,n="";this.extra="";for(var i=0;i<this.options.length&&!e;i++)this.options[i].name.toLowerCase()===t.toLowerCase()&&(n=this.options[i].id,this.extra=this.options[i].extra,this.options[i].name===t&&(e=!0));return n},selectItem:function(t){this.closeList(),this.curr=0,this.update(t)},activeItem:function(t){return t+1==this.curr},onHover:function(t){for(var e=0;e<this.options.length;e++)this.options[e].name==t&&(this.curr=e+1)},update:function(t){var e=this,n=this.determineValue(t);this.$emit("input",{text:t,id:n,extra:this.extra}),Vue.nextTick(function(){var t=e.$refs.list;e.setEndOfContenteditable(t)})},onInput:_.debounce(function(t){var e=this;t.length>0&&(this.closeList(),this.loading=!0,axios.get(this.uri,{params:{term:t,options:this.with}}).then(function(t){e.options=[],_.forEach(t.data,function(t){t.name=e.formatString(t.name),e.options.push(t)}),e.options.length>0&&(e.showList=!0),e.loading=!1})),this.update(t)},500),formatString:function(t){var e=t.replace(/<(?:.|\n)*?>/gm,"");return e.length>60&&(e=e.substring(0,60),e+="..."),e},onKeyUp:function(t){40==t?this.handleDownKey():38==t&&this.handleUpKey()},handleDownKey:function(){this.showList&&(this.curr++,this.curr%=this.options.length+1,this.curr>0&&this.update(this.options[this.curr-1].name))},handleUpKey:function(){this.curr+=this.options.length,this.curr%=this.options.length+1,this.curr>0&&this.update(this.options[this.curr-1].name)},reset:function(){this.update("")}}},o=n("XyMi"),a=Object(o.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"on-clickaway",rawName:"v-on-clickaway",value:t.closeList,expression:"closeList"}],staticClass:"alg-ajax-list"},[n("div",{staticClass:"control has-icon has-icon-right"},[n("div",{staticClass:"alg-datalist-container"},[n("div",{ref:"list",staticClass:"input single-line",attrs:{id:t.id,type:"text",autocomplete:"off",rows:"1",placeholder:t.placeholder,disabled:t.disabled},domProps:{innerHTML:t._s(t.value.text)},on:{input:function(e){t.onInput(e.target.textContent)},keyup:function(e){t.onKeyUp(e.keyCode)},keydown:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.onEnter(e)}}}),t._v(" "),n("input",{attrs:{type:"hidden",name:t.name},domProps:{value:t.value.text}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showList&&t.options.length>0&&t.value.text.length>0,expression:"showList && options.length > 0 && value.text.length > 0"}],staticClass:"box alg-datalist-dropdown"},[n("ul",{staticStyle:{"white-space":"nowrap"}},t._l(t.options,function(e,i){return n("li",[n("a",{class:{"is-highlighted":t.activeItem(i)},domProps:{innerHTML:t._s(e.name)},on:{click:function(n){t.selectItem(e.name)},mouseover:function(n){t.onHover(e.name)}}})])}))]),t._v(" "),n("span",{staticClass:"icon is-small"},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"fa fa-spinner fa-pulse fa-3x fa-fw"}),t._v(" "),n("i",{directives:[{name:"show",rawName:"v-show",value:t.showCheck,expression:"showCheck"}],staticClass:"fa fa-check",staticStyle:{color:"green"}})])])]),t._v(" "),n("input",{attrs:{type:"hidden",name:t.name+"_id"},domProps:{value:t.value.id}}),t._v(" "),n("input",{attrs:{type:"hidden",name:t.name+"_extra"},domProps:{value:t.extra}})])},[],!1,null,null,null);e.default=a.exports},WEHx:function(t,e,n){"use strict";var i=n("I3G/");i="default"in i?i.default:i;/^2\./.test(i.version)||i.util.warn("VueClickaway 2.1.0 only supports Vue 2.x, and does not support Vue "+i.version);var s="_vue_clickaway_handler";function o(t,e){a(t);var n=e.value;if("function"==typeof n){var i=!1;setTimeout(function(){i=!0},0),t[s]=function(e){if(i&&!t.contains(e.target))return n(e)},document.documentElement.addEventListener("click",t[s],!1)}}function a(t){document.documentElement.removeEventListener("click",t[s],!1),delete t[s]}var r={bind:o,update:function(t,e){e.value!==e.oldValue&&o(t,e)},unbind:a},c={directives:{onClickaway:r}};e.version="2.1.0",e.directive=r,e.mixin=c}});